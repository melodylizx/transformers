06/09/2024 18:36:43 - WARNING - __main__ - Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: False, 16-bits training: False
06/09/2024 18:36:43 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
accelerator_config={'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'non_blocking': False, 'gradient_accumulation_kwargs': None, 'use_configured_state': False},
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
batch_eval_metrics=False,
bf16=False,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=None,
disable_tqdm=False,
dispatch_batches=None,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_delay=0,
eval_do_concat_batches=True,
eval_on_start=False,
eval_steps=None,
eval_strategy=no,
evaluation_strategy=None,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=0,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=/network/scratch/z/zixuan.li/gpt2_ckpts/runs/Jun09_18-36-43_cn-g028.server.mila.quebec,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=500,
logging_strategy=steps,
lr_scheduler_kwargs={},
lr_scheduler_type=linear,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_train_epochs=200.0,
optim=adamw_torch,
optim_args=None,
optim_target_modules=None,
output_dir=/network/scratch/z/zixuan.li/gpt2_ckpts,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=8,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=[],
restore_callback_states_from_checkpoint=False,
resume_from_checkpoint=None,
run_name=/network/scratch/z/zixuan.li/gpt2_ckpts,
save_on_each_node=False,
save_only_model=False,
save_safetensors=True,
save_steps=500,
save_strategy=steps,
save_total_limit=None,
seed=42,
skip_memory_metrics=True,
split_batches=None,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_mps_device=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
06/09/2024 18:36:45 - INFO - datasets.builder - Overwrite dataset info from restored data version if exists.
06/09/2024 18:36:45 - INFO - datasets.info - Loading Dataset info from /home/mila/z/zixuan.li/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
06/09/2024 18:36:45 - INFO - datasets.builder - Found cached dataset wikitext (/home/mila/z/zixuan.li/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3)
06/09/2024 18:36:45 - INFO - datasets.info - Loading Dataset info from /home/mila/z/zixuan.li/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
06/09/2024 18:36:45 - WARNING - __main__ - You are instantiating a new config instance from scratch.
06/09/2024 18:36:47 - INFO - __main__ - Training new model from scratch - Total size=118.68M params
06/09/2024 18:36:47 - INFO - datasets.arrow_dataset - Loading cached processed dataset at /home/mila/z/zixuan.li/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-24f5302b824080b8.arrow
06/09/2024 18:36:47 - INFO - datasets.arrow_dataset - Loading cached processed dataset at /home/mila/z/zixuan.li/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-38a62f26547cea30.arrow
06/09/2024 18:36:47 - INFO - datasets.arrow_dataset - Loading cached processed dataset at /home/mila/z/zixuan.li/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-c75285d115ff6176.arrow
06/09/2024 18:36:47 - INFO - datasets.arrow_dataset - Loading cached processed dataset at /home/mila/z/zixuan.li/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-11021e805cc2f0aa.arrow
06/09/2024 18:36:47 - INFO - datasets.arrow_dataset - Loading cached processed dataset at /home/mila/z/zixuan.li/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-05e2d75c0aaf4f13.arrow
06/09/2024 18:36:47 - INFO - datasets.arrow_dataset - Loading cached processed dataset at /home/mila/z/zixuan.li/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-e8014a8ce34ae12b.arrow
{'loss': 6.8018, 'grad_norm': 1.2490633726119995, 'learning_rate': 4.9568965517241384e-05, 'epoch': 1.72}
{'loss': 5.9769, 'grad_norm': 1.3230533599853516, 'learning_rate': 4.913793103448276e-05, 'epoch': 3.45}
{'loss': 5.6069, 'grad_norm': 1.6149811744689941, 'learning_rate': 4.870689655172414e-05, 'epoch': 5.17}
{'loss': 5.2773, 'grad_norm': 1.4508520364761353, 'learning_rate': 4.827586206896552e-05, 'epoch': 6.9}
{'loss': 4.9775, 'grad_norm': 1.7885929346084595, 'learning_rate': 4.78448275862069e-05, 'epoch': 8.62}
{'loss': 4.7282, 'grad_norm': 2.0221505165100098, 'learning_rate': 4.741379310344828e-05, 'epoch': 10.34}
{'loss': 4.5028, 'grad_norm': 2.269731044769287, 'learning_rate': 4.698275862068966e-05, 'epoch': 12.07}
{'loss': 4.2693, 'grad_norm': 2.459665298461914, 'learning_rate': 4.655172413793104e-05, 'epoch': 13.79}
{'loss': 4.0624, 'grad_norm': 2.635601758956909, 'learning_rate': 4.612068965517242e-05, 'epoch': 15.52}
{'loss': 3.8753, 'grad_norm': 2.896740674972534, 'learning_rate': 4.5689655172413794e-05, 'epoch': 17.24}
{'loss': 3.6994, 'grad_norm': 3.1902709007263184, 'learning_rate': 4.5258620689655176e-05, 'epoch': 18.97}
{'loss': 3.4958, 'grad_norm': 3.391091823577881, 'learning_rate': 4.482758620689655e-05, 'epoch': 20.69}
{'loss': 3.3368, 'grad_norm': 3.57136869430542, 'learning_rate': 4.4396551724137933e-05, 'epoch': 22.41}
{'loss': 3.1853, 'grad_norm': 4.0452704429626465, 'learning_rate': 4.396551724137931e-05, 'epoch': 24.14}
{'loss': 3.0131, 'grad_norm': 4.078698635101318, 'learning_rate': 4.353448275862069e-05, 'epoch': 25.86}
{'loss': 2.8601, 'grad_norm': 4.153478145599365, 'learning_rate': 4.3103448275862066e-05, 'epoch': 27.59}
{'loss': 2.719, 'grad_norm': 4.278058052062988, 'learning_rate': 4.267241379310345e-05, 'epoch': 29.31}
{'loss': 2.5927, 'grad_norm': 4.285464763641357, 'learning_rate': 4.224137931034483e-05, 'epoch': 31.03}
{'loss': 2.4409, 'grad_norm': 4.531435012817383, 'learning_rate': 4.1810344827586205e-05, 'epoch': 32.76}
{'loss': 2.3177, 'grad_norm': 4.732685565948486, 'learning_rate': 4.1379310344827587e-05, 'epoch': 34.48}
{'loss': 2.1981, 'grad_norm': 4.626790523529053, 'learning_rate': 4.094827586206897e-05, 'epoch': 36.21}
{'loss': 2.0883, 'grad_norm': 4.95209264755249, 'learning_rate': 4.0517241379310344e-05, 'epoch': 37.93}
{'loss': 1.9586, 'grad_norm': 5.296106338500977, 'learning_rate': 4.0086206896551726e-05, 'epoch': 39.66}
{'loss': 1.8563, 'grad_norm': 5.035101413726807, 'learning_rate': 3.965517241379311e-05, 'epoch': 41.38}
{'loss': 1.7602, 'grad_norm': 4.969764232635498, 'learning_rate': 3.922413793103448e-05, 'epoch': 43.1}
{'loss': 1.6531, 'grad_norm': 5.300549507141113, 'learning_rate': 3.8793103448275865e-05, 'epoch': 44.83}
{'loss': 1.5517, 'grad_norm': 4.971456527709961, 'learning_rate': 3.8362068965517246e-05, 'epoch': 46.55}
{'loss': 1.4633, 'grad_norm': 5.162820339202881, 'learning_rate': 3.793103448275862e-05, 'epoch': 48.28}
{'loss': 1.3837, 'grad_norm': 5.92341423034668, 'learning_rate': 3.7500000000000003e-05, 'epoch': 50.0}
{'loss': 1.2778, 'grad_norm': 4.746050834655762, 'learning_rate': 3.7068965517241385e-05, 'epoch': 51.72}
{'loss': 1.2062, 'grad_norm': 5.128377914428711, 'learning_rate': 3.663793103448276e-05, 'epoch': 53.45}
{'loss': 1.1312, 'grad_norm': 4.7261881828308105, 'learning_rate': 3.620689655172414e-05, 'epoch': 55.17}
{'loss': 1.0569, 'grad_norm': 4.996994495391846, 'learning_rate': 3.5775862068965524e-05, 'epoch': 56.9}
{'loss': 0.9775, 'grad_norm': 5.048656463623047, 'learning_rate': 3.53448275862069e-05, 'epoch': 58.62}
{'loss': 0.9154, 'grad_norm': 4.770590305328369, 'learning_rate': 3.4913793103448275e-05, 'epoch': 60.34}
{'loss': 0.8576, 'grad_norm': 4.646380424499512, 'learning_rate': 3.4482758620689657e-05, 'epoch': 62.07}
{'loss': 0.79, 'grad_norm': 4.944072723388672, 'learning_rate': 3.405172413793103e-05, 'epoch': 63.79}
{'loss': 0.7332, 'grad_norm': 4.891015529632568, 'learning_rate': 3.3620689655172414e-05, 'epoch': 65.52}
{'loss': 0.6834, 'grad_norm': 4.632905960083008, 'learning_rate': 3.3189655172413796e-05, 'epoch': 67.24}
{'loss': 0.6388, 'grad_norm': 4.626673221588135, 'learning_rate': 3.275862068965517e-05, 'epoch': 68.97}
{'loss': 0.5824, 'grad_norm': 4.459129333496094, 'learning_rate': 3.232758620689655e-05, 'epoch': 70.69}
{'loss': 0.5448, 'grad_norm': 4.374878883361816, 'learning_rate': 3.1896551724137935e-05, 'epoch': 72.41}
{'loss': 0.5086, 'grad_norm': 4.185875415802002, 'learning_rate': 3.146551724137931e-05, 'epoch': 74.14}
{'loss': 0.4702, 'grad_norm': 4.501802444458008, 'learning_rate': 3.103448275862069e-05, 'epoch': 75.86}
{'loss': 0.4344, 'grad_norm': 4.263993740081787, 'learning_rate': 3.060344827586207e-05, 'epoch': 77.59}
{'loss': 0.4058, 'grad_norm': 3.8589437007904053, 'learning_rate': 3.017241379310345e-05, 'epoch': 79.31}
{'loss': 0.3813, 'grad_norm': 3.749464750289917, 'learning_rate': 2.974137931034483e-05, 'epoch': 81.03}
{'loss': 0.3498, 'grad_norm': 3.921832799911499, 'learning_rate': 2.9310344827586206e-05, 'epoch': 82.76}
{'loss': 0.3289, 'grad_norm': 3.7622663974761963, 'learning_rate': 2.8879310344827588e-05, 'epoch': 84.48}
{'loss': 0.3092, 'grad_norm': 3.6088194847106934, 'learning_rate': 2.844827586206897e-05, 'epoch': 86.21}
{'loss': 0.2909, 'grad_norm': 3.6705353260040283, 'learning_rate': 2.8017241379310345e-05, 'epoch': 87.93}
{'loss': 0.2694, 'grad_norm': 3.5361809730529785, 'learning_rate': 2.7586206896551727e-05, 'epoch': 89.66}
{'loss': 0.2561, 'grad_norm': 3.2578747272491455, 'learning_rate': 2.7155172413793105e-05, 'epoch': 91.38}
{'loss': 0.2424, 'grad_norm': 3.269636869430542, 'learning_rate': 2.672413793103448e-05, 'epoch': 93.1}
{'loss': 0.2265, 'grad_norm': 3.438436508178711, 'learning_rate': 2.6293103448275862e-05, 'epoch': 94.83}
{'loss': 0.2145, 'grad_norm': 3.243488311767578, 'learning_rate': 2.5862068965517244e-05, 'epoch': 96.55}
{'loss': 0.2037, 'grad_norm': 3.2267208099365234, 'learning_rate': 2.543103448275862e-05, 'epoch': 98.28}
{'loss': 0.1952, 'grad_norm': 3.8924334049224854, 'learning_rate': 2.5e-05, 'epoch': 100.0}
{'loss': 0.1824, 'grad_norm': 3.2734248638153076, 'learning_rate': 2.456896551724138e-05, 'epoch': 101.72}
{'loss': 0.1744, 'grad_norm': 3.0366013050079346, 'learning_rate': 2.413793103448276e-05, 'epoch': 103.45}
{'loss': 0.1672, 'grad_norm': 3.1271560192108154, 'learning_rate': 2.370689655172414e-05, 'epoch': 105.17}
{'loss': 0.1592, 'grad_norm': 2.9583075046539307, 'learning_rate': 2.327586206896552e-05, 'epoch': 106.9}
{'loss': 0.1508, 'grad_norm': 2.7802422046661377, 'learning_rate': 2.2844827586206897e-05, 'epoch': 108.62}
{'loss': 0.145, 'grad_norm': 2.830695867538452, 'learning_rate': 2.2413793103448276e-05, 'epoch': 110.34}
{'loss': 0.1396, 'grad_norm': 2.8082616329193115, 'learning_rate': 2.1982758620689654e-05, 'epoch': 112.07}
{'loss': 0.1321, 'grad_norm': 2.718515396118164, 'learning_rate': 2.1551724137931033e-05, 'epoch': 113.79}
{'loss': 0.1272, 'grad_norm': 2.7329611778259277, 'learning_rate': 2.1120689655172415e-05, 'epoch': 115.52}
{'loss': 0.1218, 'grad_norm': 2.3669917583465576, 'learning_rate': 2.0689655172413793e-05, 'epoch': 117.24}
{'loss': 0.1179, 'grad_norm': 2.6222403049468994, 'learning_rate': 2.0258620689655172e-05, 'epoch': 118.97}
{'loss': 0.1121, 'grad_norm': 2.6259846687316895, 'learning_rate': 1.9827586206896554e-05, 'epoch': 120.69}
{'loss': 0.1083, 'grad_norm': 2.5529372692108154, 'learning_rate': 1.9396551724137932e-05, 'epoch': 122.41}
{'loss': 0.1046, 'grad_norm': 2.397728443145752, 'learning_rate': 1.896551724137931e-05, 'epoch': 124.14}
{'loss': 0.1002, 'grad_norm': 2.260636806488037, 'learning_rate': 1.8534482758620693e-05, 'epoch': 125.86}
{'loss': 0.0961, 'grad_norm': 2.3902673721313477, 'learning_rate': 1.810344827586207e-05, 'epoch': 127.59}
{'loss': 0.0929, 'grad_norm': 2.3315916061401367, 'learning_rate': 1.767241379310345e-05, 'epoch': 129.31}
{'loss': 0.0901, 'grad_norm': 2.1866273880004883, 'learning_rate': 1.7241379310344828e-05, 'epoch': 131.03}
{'loss': 0.0856, 'grad_norm': 2.2867157459259033, 'learning_rate': 1.6810344827586207e-05, 'epoch': 132.76}
{'loss': 0.0834, 'grad_norm': 2.33263897895813, 'learning_rate': 1.6379310344827585e-05, 'epoch': 134.48}
{'loss': 0.0804, 'grad_norm': 1.9496755599975586, 'learning_rate': 1.5948275862068967e-05, 'epoch': 136.21}
{'loss': 0.0779, 'grad_norm': 2.263540744781494, 'learning_rate': 1.5517241379310346e-05, 'epoch': 137.93}
{'loss': 0.0749, 'grad_norm': 1.93123197555542, 'learning_rate': 1.5086206896551724e-05, 'epoch': 139.66}
{'loss': 0.0725, 'grad_norm': 2.073441505432129, 'learning_rate': 1.4655172413793103e-05, 'epoch': 141.38}
{'loss': 0.0704, 'grad_norm': 1.8260440826416016, 'learning_rate': 1.4224137931034485e-05, 'epoch': 143.1}
{'loss': 0.0676, 'grad_norm': 2.052478790283203, 'learning_rate': 1.3793103448275863e-05, 'epoch': 144.83}
{'loss': 0.0655, 'grad_norm': 1.8319426774978638, 'learning_rate': 1.336206896551724e-05, 'epoch': 146.55}
{'loss': 0.0635, 'grad_norm': 1.9415775537490845, 'learning_rate': 1.2931034482758622e-05, 'epoch': 148.28}
{'loss': 0.0619, 'grad_norm': 2.3053598403930664, 'learning_rate': 1.25e-05, 'epoch': 150.0}
{'loss': 0.0594, 'grad_norm': 1.9487109184265137, 'learning_rate': 1.206896551724138e-05, 'epoch': 151.72}
{'loss': 0.0576, 'grad_norm': 1.8537274599075317, 'learning_rate': 1.163793103448276e-05, 'epoch': 153.45}
{'loss': 0.0562, 'grad_norm': 1.857709527015686, 'learning_rate': 1.1206896551724138e-05, 'epoch': 155.17}
{'loss': 0.0543, 'grad_norm': 1.8345487117767334, 'learning_rate': 1.0775862068965516e-05, 'epoch': 156.9}
{'loss': 0.0523, 'grad_norm': 1.8770939111709595, 'learning_rate': 1.0344827586206897e-05, 'epoch': 158.62}
{'loss': 0.051, 'grad_norm': 1.726936936378479, 'learning_rate': 9.913793103448277e-06, 'epoch': 160.34}
{'loss': 0.0494, 'grad_norm': 1.8252671957015991, 'learning_rate': 9.482758620689655e-06, 'epoch': 162.07}
{'loss': 0.0477, 'grad_norm': 1.6668318510055542, 'learning_rate': 9.051724137931036e-06, 'epoch': 163.79}
{'loss': 0.0464, 'grad_norm': 1.7212613821029663, 'learning_rate': 8.620689655172414e-06, 'epoch': 165.52}
{'loss': 0.045, 'grad_norm': 1.6474844217300415, 'learning_rate': 8.189655172413793e-06, 'epoch': 167.24}
{'loss': 0.044, 'grad_norm': 1.8320308923721313, 'learning_rate': 7.758620689655173e-06, 'epoch': 168.97}
{'loss': 0.0424, 'grad_norm': 1.6280245780944824, 'learning_rate': 7.3275862068965514e-06, 'epoch': 170.69}
{'loss': 0.0411, 'grad_norm': 1.537747859954834, 'learning_rate': 6.896551724137932e-06, 'epoch': 172.41}
{'loss': 0.0401, 'grad_norm': 1.6540225744247437, 'learning_rate': 6.465517241379311e-06, 'epoch': 174.14}
{'loss': 0.039, 'grad_norm': 1.464495301246643, 'learning_rate': 6.03448275862069e-06, 'epoch': 175.86}
{'loss': 0.038, 'grad_norm': 1.550977110862732, 'learning_rate': 5.603448275862069e-06, 'epoch': 177.59}
{'loss': 0.0369, 'grad_norm': 1.5473676919937134, 'learning_rate': 5.172413793103448e-06, 'epoch': 179.31}
{'loss': 0.0361, 'grad_norm': 1.462234377861023, 'learning_rate': 4.741379310344828e-06, 'epoch': 181.03}
{'loss': 0.0349, 'grad_norm': 1.565974473953247, 'learning_rate': 4.310344827586207e-06, 'epoch': 182.76}
{'loss': 0.034, 'grad_norm': 1.4195382595062256, 'learning_rate': 3.8793103448275865e-06, 'epoch': 184.48}
{'loss': 0.0333, 'grad_norm': 1.3220207691192627, 'learning_rate': 3.448275862068966e-06, 'epoch': 186.21}
{'loss': 0.0324, 'grad_norm': 1.3958117961883545, 'learning_rate': 3.017241379310345e-06, 'epoch': 187.93}
{'loss': 0.0317, 'grad_norm': 1.4207013845443726, 'learning_rate': 2.586206896551724e-06, 'epoch': 189.66}
{'loss': 0.031, 'grad_norm': 1.3016968965530396, 'learning_rate': 2.1551724137931035e-06, 'epoch': 191.38}
{'loss': 0.0305, 'grad_norm': 1.1463005542755127, 'learning_rate': 1.724137931034483e-06, 'epoch': 193.1}
{'loss': 0.0298, 'grad_norm': 1.2767398357391357, 'learning_rate': 1.293103448275862e-06, 'epoch': 194.83}
{'loss': 0.0292, 'grad_norm': 1.2119113206863403, 'learning_rate': 8.620689655172415e-07, 'epoch': 196.55}
{'loss': 0.0289, 'grad_norm': 1.4686425924301147, 'learning_rate': 4.3103448275862073e-07, 'epoch': 198.28}
{'loss': 0.0285, 'grad_norm': 1.4267990589141846, 'learning_rate': 0.0, 'epoch': 200.0}
{'train_runtime': 34041.4407, 'train_samples_per_second': 13.619, 'train_steps_per_second': 1.704, 'train_loss': 1.0038015837504946, 'epoch': 200.0}
***** train metrics *****
  epoch                    =       200.0
  total_flos               = 225631494GF
  train_loss               =      1.0038
  train_runtime            =  9:27:21.44
  train_samples            =        2318
  train_samples_per_second =      13.619
  train_steps_per_second   =       1.704
06/10/2024 04:04:10 - INFO - __main__ - *** Evaluate ***
***** eval metrics *****
  epoch                   =      200.0
  eval_accuracy           =     0.2098
  eval_loss               =     9.4492
  eval_runtime            = 0:00:06.76
  eval_samples            =        240
  eval_samples_per_second =     35.499
  eval_steps_per_second   =      4.437
  perplexity              = 12698.4468

======== GPU REPORT ========

==============NVSMI LOG==============

Timestamp                                 : Mon Jun 10 04:04:19 2024
Driver Version                            : 535.161.08
CUDA Version                              : 12.2

Attached GPUs                             : 1
GPU 00000000:41:00.0
    Accounting Mode                       : Enabled
    Accounting Mode Buffer Size           : 4000
    Accounted Processes
        Process ID                        : 2648350
            GPU Utilization               : 97 %
            Memory Utilization            : 31 %
            Max memory usage              : 29408 MiB
            Time                          : 34058346 ms
            Is Running                    : 0

Mon Jun 10 04:04:19 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.161.08             Driver Version: 535.161.08   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  | 00000000:41:00.0 Off |                    0 |
| N/A   37C    P0              82W / 500W |      0MiB / 81920MiB |     39%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
