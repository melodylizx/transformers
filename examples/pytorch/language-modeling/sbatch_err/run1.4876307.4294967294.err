Overwrite dataset info from restored data version if exists.
Loading Dataset info from /home/mila/z/zixuan.li/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
Found cached dataset wikitext (/home/mila/z/zixuan.li/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3)
Loading Dataset info from /home/mila/z/zixuan.li/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3
[INFO|tokenization_utils_base.py:2106] 2024-06-15 16:50:03,950 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2106] 2024-06-15 16:50:03,950 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2106] 2024-06-15 16:50:03,950 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2106] 2024-06-15 16:50:03,950 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2106] 2024-06-15 16:50:03,950 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2106] 2024-06-15 16:50:03,950 >> loading file tokenizer_config.json
[INFO|configuration_utils.py:1000] 2024-06-15 16:50:04,031 >> Generate config GenerationConfig {
  "bos_token_id": 50256,
  "eos_token_id": 50256
}

Loading cached processed dataset at /home/mila/z/zixuan.li/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-24f5302b824080b8.arrow
Loading cached processed dataset at /home/mila/z/zixuan.li/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-38a62f26547cea30.arrow
Loading cached processed dataset at /home/mila/z/zixuan.li/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-c75285d115ff6176.arrow
Loading cached processed dataset at /home/mila/z/zixuan.li/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-11021e805cc2f0aa.arrow
Loading cached processed dataset at /home/mila/z/zixuan.li/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-05e2d75c0aaf4f13.arrow
Loading cached processed dataset at /home/mila/z/zixuan.li/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3/cache-e8014a8ce34ae12b.arrow
[INFO|trainer.py:2108] 2024-06-15 16:50:06,403 >> ***** Running training *****
[INFO|trainer.py:2109] 2024-06-15 16:50:06,403 >>   Num examples = 2,318
[INFO|trainer.py:2110] 2024-06-15 16:50:06,403 >>   Num Epochs = 1,000
[INFO|trainer.py:2111] 2024-06-15 16:50:06,403 >>   Instantaneous batch size per device = 8
[INFO|trainer.py:2113] 2024-06-15 16:50:06,403 >>   Training with DataParallel so batch size has been adjusted to: 16
[INFO|trainer.py:2114] 2024-06-15 16:50:06,403 >>   Total train batch size (w. parallel, distributed & accumulation) = 16
[INFO|trainer.py:2115] 2024-06-15 16:50:06,403 >>   Gradient Accumulation steps = 1
[INFO|trainer.py:2116] 2024-06-15 16:50:06,403 >>   Total optimization steps = 145,000
[INFO|trainer.py:2117] 2024-06-15 16:50:06,404 >>   Number of trainable parameters = 124,439,808
  0%|                                                                                           | 0/145000 [00:00<?, ?it/s]/home/mila/z/zixuan.li/.conda/envs/new/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  0%|                                                                                | 1/145000 [00:01<75:02:10,  1.86s/it]  0%|                                                                                | 2/145000 [00:02<46:44:25,  1.16s/it]  0%|                                                                                | 3/145000 [00:03<37:21:31,  1.08it/s]  0%|                                                                                | 4/145000 [00:03<33:13:18,  1.21it/s]  0%|                                                                                | 5/145000 [00:04<30:49:31,  1.31it/s]  0%|                                                                                | 6/145000 [00:05<29:15:50,  1.38it/s]  0%|                                                                                | 7/145000 [00:05<28:21:35,  1.42it/s]  0%|                                                                                | 8/145000 [00:06<27:37:56,  1.46it/s]  0%|                                                                                | 9/145000 [00:07<27:12:44,  1.48it/s]  0%|                                                                               | 10/145000 [00:07<27:12:34,  1.48it/s]  0%|                                                                               | 11/145000 [00:08<26:56:57,  1.49it/s]  0%|                                                                               | 12/145000 [00:09<26:45:53,  1.50it/s]  0%|                                                                               | 13/145000 [00:09<26:34:26,  1.52it/s]  0%|                                                                               | 14/145000 [00:10<26:47:06,  1.50it/s]  0%|                                                                               | 15/145000 [00:11<26:35:51,  1.51it/s]  0%|                                                                               | 16/145000 [00:11<26:28:18,  1.52it/s]  0%|                                                                               | 17/145000 [00:12<26:21:03,  1.53it/s]  0%|                                                                               | 18/145000 [00:13<26:30:55,  1.52it/s]  0%|                                                                               | 19/145000 [00:13<26:23:34,  1.53it/s]  0%|                                                                               | 20/145000 [00:14<26:15:45,  1.53it/s]  0%|                                                                               | 21/145000 [00:14<26:13:34,  1.54it/s]  0%|                                                                               | 22/145000 [00:15<26:10:26,  1.54it/s]  0%|                                                                               | 23/145000 [00:16<26:06:20,  1.54it/s]  0%|                                                                               | 24/145000 [00:16<26:05:43,  1.54it/s]  0%|                                                                               | 25/145000 [00:17<26:04:13,  1.54it/s]  0%|                                                                               | 26/145000 [00:18<26:05:31,  1.54it/s]  0%|                                                                               | 27/145000 [00:18<26:03:27,  1.55it/s]  0%|                                                                               | 28/145000 [00:19<26:01:59,  1.55it/s]  0%|                                                                               | 29/145000 [00:20<25:59:25,  1.55it/s]  0%|                                                                               | 30/145000 [00:20<25:59:20,  1.55it/s]  0%|                                                                               | 31/145000 [00:21<25:56:51,  1.55it/s]  0%|                                                                               | 32/145000 [00:22<25:55:31,  1.55it/s]  0%|                                                                               | 33/145000 [00:22<25:57:17,  1.55it/s]  0%|                                                                               | 34/145000 [00:23<26:00:27,  1.55it/s]  0%|                                                                               | 35/145000 [00:24<26:00:44,  1.55it/s]  0%|                                                                               | 36/145000 [00:24<25:57:35,  1.55it/s]  0%|                                                                               | 37/145000 [00:25<25:58:10,  1.55it/s]  0%|                                                                               | 38/145000 [00:25<25:54:44,  1.55it/s]  0%|                                                                               | 39/145000 [00:26<25:53:36,  1.56it/s]  0%|                                                                               | 40/145000 [00:27<25:53:24,  1.56it/s]  0%|                                                                               | 41/145000 [00:27<25:53:32,  1.56it/s]  0%|                                                                               | 42/145000 [00:28<25:53:43,  1.55it/s]  0%|                                                                               | 43/145000 [00:29<25:52:33,  1.56it/s]  0%|                                                                               | 44/145000 [00:29<25:53:28,  1.56it/s]  0%|                                                                               | 45/145000 [00:30<25:54:07,  1.55it/s]  0%|                                                                               | 46/145000 [00:31<25:53:01,  1.56it/s]  0%|                                                                               | 47/145000 [00:31<25:52:50,  1.56it/s]  0%|                                                                               | 48/145000 [00:32<25:53:15,  1.56it/s]  0%|                                                                               | 49/145000 [00:33<25:52:00,  1.56it/s]  0%|                                                                               | 50/145000 [00:33<25:50:22,  1.56it/s]  0%|                                                                               | 51/145000 [00:34<25:51:30,  1.56it/s]  0%|                                                                               | 52/145000 [00:34<25:53:50,  1.55it/s]  0%|                                                                               | 53/145000 [00:35<25:52:53,  1.56it/s]  0%|                                                                               | 54/145000 [00:36<26:00:23,  1.55it/s]  0%|                                                                               | 55/145000 [00:36<25:56:22,  1.55it/s]  0%|                                                                               | 56/145000 [00:37<25:54:43,  1.55it/s]  0%|                                                                               | 57/145000 [00:38<25:53:42,  1.55it/s]  0%|                                                                               | 58/145000 [00:38<25:52:33,  1.56it/s]  0%|                                                                               | 59/145000 [00:39<25:52:55,  1.56it/s]  0%|                                                                               | 60/145000 [00:40<25:51:56,  1.56it/s]  0%|                                                                               | 61/145000 [00:40<25:50:19,  1.56it/s]  0%|                                                                               | 62/145000 [00:41<25:50:06,  1.56it/s]  0%|                                                                               | 63/145000 [00:42<25:50:03,  1.56it/s]  0%|                                                                               | 64/145000 [00:42<25:49:41,  1.56it/s]  0%|                                                                               | 65/145000 [00:43<25:52:49,  1.56it/s]  0%|                                                                               | 66/145000 [00:43<25:51:44,  1.56it/s]  0%|                                                                               | 67/145000 [00:44<25:49:44,  1.56it/s]  0%|                                                                               | 68/145000 [00:45<25:50:08,  1.56it/s]  0%|                                                                               | 69/145000 [00:45<26:00:39,  1.55it/s]  0%|                                                                               | 70/145000 [00:46<25:57:20,  1.55it/s]  0%|                                                                               | 71/145000 [00:47<26:13:29,  1.54it/s]  0%|                                                                               | 72/145000 [00:47<26:06:49,  1.54it/s]  0%|                                                                               | 73/145000 [00:48<26:21:49,  1.53it/s]  0%|                                                                               | 74/145000 [00:49<26:11:15,  1.54it/s]  0%|                                                                               | 75/145000 [00:49<26:03:35,  1.54it/s]  0%|                                                                               | 76/145000 [00:50<25:59:06,  1.55it/s]  0%|                                                                               | 77/145000 [00:51<25:54:59,  1.55it/s]  0%|                                                                               | 78/145000 [00:51<25:51:22,  1.56it/s]  0%|                                                                               | 79/145000 [00:52<25:49:46,  1.56it/s]  0%|                                                                               | 80/145000 [00:52<25:49:25,  1.56it/s]  0%|                                                                               | 81/145000 [00:53<25:49:46,  1.56it/s]  0%|                                                                               | 82/145000 [00:54<25:50:04,  1.56it/s]  0%|                                                                               | 83/145000 [00:54<25:49:26,  1.56it/s]  0%|                                                                               | 84/145000 [00:55<25:47:27,  1.56it/s]  0%|                                                                               | 85/145000 [00:56<25:46:15,  1.56it/s]  0%|                                                                               | 86/145000 [00:56<25:45:35,  1.56it/s]  0%|                                                                               | 87/145000 [00:57<25:45:43,  1.56it/s]  0%|                                                                               | 88/145000 [00:58<25:45:10,  1.56it/s]  0%|                                                                               | 89/145000 [00:58<25:45:08,  1.56it/s]  0%|                                                                               | 90/145000 [00:59<25:44:46,  1.56it/s]  0%|                                                                               | 91/145000 [01:00<25:43:27,  1.56it/s]  0%|                                                                               | 92/145000 [01:00<25:44:00,  1.56it/s]  0%|                                                                               | 93/145000 [01:01<25:44:36,  1.56it/s]  0%|                                                                               | 94/145000 [01:01<25:45:13,  1.56it/s]  0%|                                                                               | 95/145000 [01:02<25:45:05,  1.56it/s]  0%|                                                                               | 96/145000 [01:03<25:49:50,  1.56it/s]  0%|                                                                               | 97/145000 [01:03<25:47:23,  1.56it/s]  0%|                                                                               | 98/145000 [01:04<26:04:47,  1.54it/s]  0%|                                                                               | 99/145000 [01:05<25:59:26,  1.55it/s]  0%|                                                                              | 100/145000 [01:05<26:13:24,  1.53it/s]  0%|                                                                              | 101/145000 [01:06<26:05:15,  1.54it/s]  0%|                                                                              | 102/145000 [01:07<26:04:53,  1.54it/s]  0%|                                                                              | 103/145000 [01:07<25:57:53,  1.55it/s]  0%|                                                                              | 104/145000 [01:08<26:01:53,  1.55it/s]  0%|                                                                              | 105/145000 [01:09<25:57:32,  1.55it/s]  0%|                                                                              | 106/145000 [01:09<25:53:11,  1.55it/s]  0%|                                                                              | 107/145000 [01:10<25:50:25,  1.56it/s]  0%|                                                                              | 108/145000 [01:10<25:48:13,  1.56it/s]  0%|                                                                              | 109/145000 [01:11<25:46:51,  1.56it/s]  0%|                                                                              | 110/145000 [01:12<25:45:05,  1.56it/s]  0%|                                                                              | 111/145000 [01:12<25:44:02,  1.56it/s]  0%|                                                                              | 112/145000 [01:13<25:42:59,  1.57it/s]  0%|                                                                              | 113/145000 [01:14<25:43:51,  1.56it/s]  0%|                                                                              | 114/145000 [01:14<25:43:28,  1.56it/s]  0%|                                                                              | 115/145000 [01:15<26:02:51,  1.55it/s]  0%|                                                                              | 116/145000 [01:16<25:56:44,  1.55it/s]  0%|                                                                              | 117/145000 [01:16<25:51:47,  1.56it/s]  0%|                                                                              | 118/145000 [01:17<25:48:47,  1.56it/s]  0%|                                                                              | 119/145000 [01:18<25:50:00,  1.56it/s]  0%|                                                                              | 120/145000 [01:18<25:48:03,  1.56it/s]  0%|                                                                              | 121/145000 [01:19<25:46:57,  1.56it/s]  0%|                                                                              | 122/145000 [01:19<25:45:29,  1.56it/s]  0%|                                                                              | 123/145000 [01:20<25:44:34,  1.56it/s]  0%|                                                                              | 124/145000 [01:21<25:46:28,  1.56it/s]  0%|                                                                              | 125/145000 [01:21<25:45:56,  1.56it/s]  0%|                                                                              | 126/145000 [01:22<25:44:08,  1.56it/s]  0%|                                                                              | 127/145000 [01:23<25:43:33,  1.56it/s]  0%|                                                                              | 128/145000 [01:23<25:43:06,  1.56it/s]  0%|                                                                              | 129/145000 [01:24<25:42:49,  1.56it/s]  0%|                                                                              | 130/145000 [01:25<25:41:35,  1.57it/s]  0%|                                                                              | 131/145000 [01:25<25:42:36,  1.57it/s]  0%|                                                                              | 132/145000 [01:26<25:41:49,  1.57it/s]  0%|                                                                              | 133/145000 [01:26<25:41:06,  1.57it/s]  0%|                                                                              | 134/145000 [01:27<25:43:43,  1.56it/s]  0%|                                                                              | 135/145000 [01:28<25:46:06,  1.56it/s]  0%|                                                                              | 136/145000 [01:28<25:44:49,  1.56it/s]  0%|                                                                              | 137/145000 [01:29<25:43:44,  1.56it/s]  0%|                                                                              | 138/145000 [01:30<25:42:53,  1.56it/s]  0%|                                                                              | 139/145000 [01:30<25:43:03,  1.56it/s]  0%|                                                                              | 140/145000 [01:31<25:41:58,  1.57it/s]  0%|                                                                              | 141/145000 [01:32<25:41:09,  1.57it/s]  0%|                                                                              | 142/145000 [01:32<25:40:32,  1.57it/s]  0%|                                                                              | 143/145000 [01:33<25:40:20,  1.57it/s]  0%|                                                                              | 144/145000 [01:34<25:39:04,  1.57it/s]Traceback (most recent call last):
  File "/home/mila/z/zixuan.li/transformers/examples/pytorch/language-modeling/run_clm.py", line 654, in <module>
    main()
  File "/home/mila/z/zixuan.li/transformers/examples/pytorch/language-modeling/run_clm.py", line 602, in main
    train_result = trainer.train(resume_from_checkpoint=checkpoint)
  File "/home/mila/z/zixuan.li/.conda/envs/new/lib/python3.9/site-packages/transformers/trainer.py", line 1912, in train
    return inner_training_loop(
  File "/home/mila/z/zixuan.li/.conda/envs/new/lib/python3.9/site-packages/transformers/trainer.py", line 2248, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
  File "/home/mila/z/zixuan.li/.conda/envs/new/lib/python3.9/site-packages/transformers/trainer.py", line 3278, in training_step
    torch.cuda.empty_cache()
  File "/home/mila/z/zixuan.li/.conda/envs/new/lib/python3.9/site-packages/torch/cuda/memory.py", line 162, in empty_cache
    torch._C._cuda_emptyCache()
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

  0%|                                                                              | 144/145000 [01:34<26:28:24,  1.52it/s]
